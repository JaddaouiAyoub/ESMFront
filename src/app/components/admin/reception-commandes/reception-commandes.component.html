<div class="p-4">
  <h2 class="text-xl font-bold mb-4">Commandes confirmées</h2>
  <table class="min-w-full bg-white shadow rounded">
    <thead class="bg-gray-200">
    <tr>
      <th class="px-4 py-2 text-left">Code</th>
      <th class="px-4 py-2 text-left">Date</th>
      <th class="px-4 py-2 text-left">Fournisseur</th>
      <th class="px-4 py-2 text-left">Montant</th>
      <th class="px-4 py-2 text-left">Statut</th>
      <th class="px-4 py-2 text-left">Action</th>

    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let c of commandes" class="border-t">
      <td class="px-4 py-2">{{ c.codeCommande }}</td>
      <td class="px-4 py-2">{{ c.dateCreation }}</td>
      <td class="px-4 py-2">{{ c.fournisseur.raisonSociale }}</td>
      <td class="px-4 py-2">{{ c.montantTotal }} MAD</td>
      <td class="px-4 py-2">{{ c.statut }}</td>
      <td>
        <button class="bg-blue-500 text-white px-2 py-1 rounded" (click)="ouvrirReceptionModal(c.lignes[0])">Réceptionner</button>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<ng-template [ngIf]="ligneSelectionnee">
  <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded shadow-xl w-[400px]">
      <h2 class="text-lg font-semibold mb-4">Réception - {{ ligneSelectionnee.nomProduit }}</h2>

      <label class="block mb-2">Quantité reçue :</label>
      <input type="number" [(ngModel)]="quantiteRecue" class="border rounded w-full px-2 py-1 mb-4">

      <!-- Si quantité reçue < commandée, afficher formulaire sous-ligne -->
      <div *ngIf="quantiteRecue > 0 && quantiteRecue < ligneSelectionnee.quantiteCommandee">
        <p class="text-sm text-red-500">Réception partielle. Une sous-ligne sera créée.</p>
        <label>Date de réception :</label>
        <input type="date" [(ngModel)]="dateReception" class="border rounded w-full px-2 py-1 mb-4">
      </div>

      <!-- Boutons -->
      <div class="flex justify-end gap-2">
        <button class="bg-gray-300 px-4 py-1 rounded" (click)="fermerModal()">Annuler</button>
        <button class="bg-green-500 text-white px-4 py-1 rounded" (click)="validerReception()">Valider</button>
      </div>
    </div>
  </div>
</ng-template>
